"use strict";var passport=require("passport"),LocalStrategy=require("passport-local").Strategy,mongoose=require("mongoose"),Usuarios=mongoose.model("Usuarios");passport.use(new LocalStrategy({usernameField:"email",passwordField:"password"},function(r,s,t){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Usuarios.findOne({email:r}));case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",t(null,!1,{message:"Usuario No existente"}));case 5:if(a.compararPassword(s)){e.next=8;break}return e.abrupt("return",t(null,!1,{message:"Password Incorrecto"}));case 8:return e.abrupt("return",t(null,a));case 9:case"end":return e.stop()}})})),passport.serializeUser(function(e,r){return r(null,e._id)}),passport.deserializeUser(function(r,s){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Usuarios.findById(r).exec());case 2:return t=e.sent,e.abrupt("return",s(null,t));case 4:case"end":return e.stop()}})}),module.exports=passport;